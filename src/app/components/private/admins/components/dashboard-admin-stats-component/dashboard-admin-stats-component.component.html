@if (loading) {
  <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6">
    @for (_ of [1, 2, 3, 4, 5]; track $index) {
      <div class="animate-pulse bg-gray-200 rounded-lg h-32"></div>
    }
  </div>
} @else {
  <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6 mb-5">
    <!-- Card de Usuarios -->
    <app-dashboard-card
      (click)="switchChart('users')"
      [class.active]="activeChart === 'users'"
      class="transform transition-all duration-300 hover:scale-105 cursor-pointer"
      title="Usuarios"
      icon="fas fa-users"
      cardType="numeric">
    </app-dashboard-card>

    <!-- Card de Pacientes -->
    <app-dashboard-card
      (click)="switchChart('patients')"
      [class.active]="activeChart === 'patients'"
      class="transform transition-all duration-300 hover:scale-105 cursor-pointer"
      title="Pacientes"
      icon="fas fa-hospital-user"
      cardType="list">
    </app-dashboard-card>

    <!-- Card de Tratamientos -->
    <app-dashboard-card
      (click)="switchChart('treatments')"
      [class.active]="activeChart === 'treatments'"
      class="transform transition-all duration-300 hover:scale-105 cursor-pointer"
      title="Tratamientos"
      icon="fas fa-notes-medical"
      cardType="numeric">
    </app-dashboard-card>
  </div>

  <div class="flex custom-bar">
    <section class="p-4">
      <div style="width: 600px; height: 400px;">
        <canvas
          baseChart
          [type]="lineChartType"
          [data]="currentChartData"
          [options]="lineChartOptions">
        </canvas>
      </div>
    </section>

    @if (activeChart === 'users') {
      <div class="p-4 flex-1 overflow-auto">
        <div mat-subheader><p><strong>Usuarios</strong></p></div>
        <mat-list role="list">
          <mat-list-item role="listitem">Estudiantes: {{ stats.totalStudents }}</mat-list-item>
          <mat-divider></mat-divider>

          <mat-list-item role="listitem">Profesores: {{ stats.totalProfessors }}</mat-list-item>
          <mat-divider></mat-divider>

          <mat-list-item role="listitem">Estudiantes registrados el ultimo
            mes: {{ stats.studentsRegisteredLastMonth }}
          </mat-list-item>
          <mat-divider></mat-divider>

        </mat-list>
      </div>
    }

    @if (activeChart === 'patients') {
      <div class="p-4 flex-1 overflow-auto">
        <div mat-subheader><p><strong>Pacientes</strong></p></div>
        <mat-list role="list">
          <mat-list-item role="listitem">Pacientes: {{ stats.totalPatients }}</mat-list-item>
          <mat-divider></mat-divider>
          <mat-list-item role="listitem">Pacientes con discapacidad: {{ stats.patientsWithDisability }}</mat-list-item>
          <mat-divider></mat-divider>
          <mat-list-item role="listitem">Pacientes registrados el ultimo mes: {{ stats.patientsRegisteredLastMonth }}
          </mat-list-item>
        </mat-list>
      </div>
    }

    @if (activeChart === 'treatments') {
      <div class="p-4 flex-1 overflow-auto">
        <div mat-subheader><p><strong>Tratamientos</strong></p></div>
        <mat-list role="list">
          <mat-list-item role="listitem">Resinas: {{ stats.treatments.resins }}</mat-list-item>
          <mat-divider></mat-divider>

          <mat-list-item role="listitem">Profilaxis: {{ stats.treatments.prophylaxis }}</mat-list-item>
          <mat-divider></mat-divider>

          <mat-list-item role="listitem">Fluorosis: {{ stats.treatments.fluorosis }}</mat-list-item>
          <mat-divider></mat-divider>

          <mat-list-item role="listitem">Selladores de fosetas y fisuras: {{ stats.treatments.pitAndFissureSealers }}
          </mat-list-item>
          <mat-divider></mat-divider>

          <mat-list-item role="listitem">Extracciones: {{ stats.treatments.extractions }}</mat-list-item>
          <mat-divider></mat-divider>

          <mat-list-item role="listitem">Prótesis removible: {{ stats.treatments.removableProsthesis }}</mat-list-item>
          <mat-divider></mat-divider>

          <mat-list-item role="listitem">Prótesis removible (alternativo): {{ stats.treatments.prosthesisRemovable }}
          </mat-list-item>
          <mat-divider></mat-divider>

          <mat-list-item role="listitem">Prostodoncia: {{ stats.treatments.prosthodontics }}</mat-list-item>
          <mat-divider></mat-divider>

          <mat-list-item role="listitem">Endodoncia (conductos radiculares): {{ stats.treatments.rootCanals }}
          </mat-list-item>
          <mat-divider></mat-divider>

          <mat-list-item role="listitem">Raspado y alisado: {{ stats.treatments.scrapedAndSmoothed }}</mat-list-item>
          <mat-divider></mat-divider>

          <mat-list-item role="listitem">Cerrado y abierto: {{ stats.treatments.closedAndOpen }}</mat-list-item>
          <mat-divider></mat-divider>

          <mat-list-item role="listitem">Cuña distal: {{ stats.treatments.distalWedges }}</mat-list-item>
          <mat-divider></mat-divider>

          <mat-list-item role="listitem">Pulpotomía y corona: {{ stats.treatments.pulpotomyAndCrowns }}</mat-list-item>
          <mat-divider></mat-divider>

          <mat-list-item role="listitem">Pulpectomía y corona: {{ stats.treatments.pulpectomyAndCrowns }}
          </mat-list-item>
          <mat-divider></mat-divider>
        </mat-list>
      </div>
    }
  </div>

}
