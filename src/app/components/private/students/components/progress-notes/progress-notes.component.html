<div class="button-container">
  <div></div>
  <div>
    @if (role == 'ROLE_STUDENT') {
      <button type="button" mat-button (click)="openDialog()">
        Nueva nota <i class="fas fa-plus"></i>
      </button>
    }
  </div>
</div>

<mat-list class="list-custom p-4" style="height: 200px; overflow-y: auto;">

  @if (isLoading && currentPage === 0) {
    <app-loading/>
  }

  @if (progressNotesData && progressNotesData.content.length > 0) {
    @for (note of progressNotesData.content; track note.idProgressNote) {
      <mat-list-item>
        <div class="note-content">
          <div class="note-info">
            <div matListItemTitle>Nota de evoluci√≥n</div>
            <div matListItemLine>
              {{ note.creationDate | date : "dd/MM/yyyy HH:mm" }}
            </div>
          </div>
          <div class="icon-container flex items-center justify-center gap-4">
            <span class="dowload-badge cursor-pointer" (click)="dowloadFormat(note.idProgressNote)">Descargar formato</span>
            <i class="fas fa-eye cursor-pointer" (click)="viewNote(note)" aria-label="View Note"></i>
            @if (note.files && note.files.length > 0) {
              <i class="fas fa-download cursor-pointer" (click)="downloadFile(note.files[0].idProgressNoteFile)" aria-label="Download File"></i>
            } @else {
              @if (role == 'ROLE_STUDENT') {
                <i class="fas fa-paperclip cursor-pointer" (click)="attachDocument(note)" aria-label="Attach Document"></i>
              }
            }
          </div>
        </div>
      </mat-list-item>
      <hr>
    }

    @if (isLoading && currentPage > 0) {
      <app-loading/>
    }

    <br>
    <div class="load">
      @if (!isLastPage) {
        <button type="button" mat-button (click)="loadMore()" [disabled]="isLoading">
          Notas anteriores <i class="fas fa-chevron-down"></i>
        </button>
      }
    </div>

  } @else {
    <div class="p-4">No hay notas disponibles.</div>
  }
</mat-list>

<div class="button-container">
  <button type="button" mat-button (click)="previousTab()">
    <i class="fas fa-long-arrow-alt-left"></i> ANTERIOR
  </button>
  <div></div>
</div>
