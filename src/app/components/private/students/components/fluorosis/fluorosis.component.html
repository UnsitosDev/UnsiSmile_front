@if (fluorosis) {
  <div class="p-4">
    <mat-card-title><strong>Índice de Dean</strong></mat-card-title>
    <table class="w-full">
      <tr>
        <td>Diente</td>
        @for (toothPair of toothPairs; track $index) {
          <td>
            <mat-select [(ngModel)]="selectedValues[$index]" required class="no-focus-style">
              <mat-option [value]="toothPair[0]">{{ toothPair[0] }}</mat-option>
              <mat-option [value]="toothPair[1]">{{ toothPair[1] }}</mat-option>
            </mat-select>
          </td>
        }
      </tr>

      <tr>
        <td>Código</td>
        @for (toothNumber of selectedValues; track $index) {
          <td contenteditable="true"
              (input)="validateInput($event, toothNumber)"
              [textContent]="codes[toothNumber]">
          </td>
        }
      </tr>
    </table>

    <div class="mt-2 flex justify-end">
      <button mat-raised-button color="primary" (click)="store()">
        Guardar índice de Dean
      </button>
    </div>
  </div>

  <mat-tab-group>
    <mat-tab label="Adulto">
      <div class="grid grid-cols-2">
        @for (quadrant of [1, 2, 4, 3]; track $index) {
          <div class="flex flex-wrap p-4 {{ $index % 2 === 0 ? 'justify-self-end' : 'justify-self-start' }}">
            @for (tooth of getQuadrant(fluorosis.adultArcade.teeth, quadrant); track tooth) {
              <div class="flex flex-col items-center p-2">
                <svg width="29" height="34">
                  <polygon
                    class="cursor-pointer"
                    stroke='black'
                    points="1,1 7,9 21,9 28,1"
                    fill="#EAEDEA"
                    [attr.fill]="isSelected(tooth.idTooth + '-1') ? 'var(--fluorosis)' : 'var(--white-color)'"
                    (click)="!toothDeactivated[tooth.idTooth] && changeColor(tooth.idTooth + '-1')"/>
                  <polygon
                    class="cursor-pointer"
                    stroke='black'
                    points="21,9 21,25 28,33 28,1"
                    fill="#EAEDEA"
                    [attr.fill]="isSelected(tooth.idTooth + '-2') ? 'var(--fluorosis)' : 'var(--white-color)'"
                    (click)="!toothDeactivated[tooth.idTooth] && changeColor(tooth.idTooth + '-2')"/>
                  <polygon
                    class="cursor-pointer"
                    stroke='black'
                    points="21,25 28,33 1,33 7,25"
                    fill="#EAEDEA"
                    [attr.fill]="isSelected(tooth.idTooth + '-3') ? 'var(--fluorosis)' : 'var(--white-color)'"
                    (click)="!toothDeactivated[tooth.idTooth] && changeColor(tooth.idTooth + '-3')"/>
                  <polygon
                    class="cursor-pointer"
                    stroke='black'
                    points="1,1 1,33 7,25 7,9"
                    fill="#EAEDEA"
                    [attr.fill]="isSelected(tooth.idTooth + '-4') ? 'var(--fluorosis)' : 'var(--white-color)'"
                    (click)="!toothDeactivated[tooth.idTooth] && changeColor(tooth.idTooth + '-4')"/>
                  <polygon
                    class="cursor-pointer"
                    stroke='black'
                    points="7,9 21,9 21,25 7,25"
                    fill="#EAEDEA"
                    [attr.fill]="isSelected(tooth.idTooth + '-5') ? 'var(--fluorosis)' : 'var(--white-color)'"
                    (click)="!toothDeactivated[tooth.idTooth] && changeColor(tooth.idTooth + '-5')"/>
                </svg>
                <span>{{ tooth.idTooth }}</span>
              </div>
            }
          </div>
        }
      </div>
    </mat-tab>
    <mat-tab label="Infantil">
      <div class="grid grid-cols-2">
        @for (quadrant of [5, 6, 8, 7]; track $index) {
          <div class="flex flex-wrap p-4 {{ $index % 2 === 0 ? 'justify-self-end' : 'justify-self-start' }}">
            @for (tooth of getQuadrantForChildren(fluorosis.childrenArcade.teeth, quadrant); track tooth) {
              <div class="flex flex-col items-center p-2">
                <svg width="29" height="34">
                  <polygon
                    class="cursor-pointer"
                    stroke='black'
                    points="1,1 7,9 21,9 28,1"
                    fill="#EAEDEA"
                    [attr.fill]="isSelected(tooth.idTooth + '-1') ? 'var(--fluorosis)' : 'var(--white-color)'"
                    (click)="!toothDeactivated[tooth.idTooth] && changeColor(tooth.idTooth + '-1')"/>
                  <polygon
                    class="cursor-pointer"
                    stroke='black'
                    points="21,9 21,25 28,33 28,1"
                    fill="#EAEDEA"
                    [attr.fill]="isSelected(tooth.idTooth + '-2') ? 'var(--fluorosis)' : 'var(--white-color)'"
                    (click)="!toothDeactivated[tooth.idTooth] && changeColor(tooth.idTooth + '-2')"/>
                  <polygon
                    class="cursor-pointer"
                    stroke='black'
                    points="21,25 28,33 1,33 7,25"
                    fill="#EAEDEA"
                    [attr.fill]="isSelected(tooth.idTooth + '-3') ? 'var(--fluorosis)' : 'var(--white-color)'"
                    (click)="!toothDeactivated[tooth.idTooth] && changeColor(tooth.idTooth + '-3')"/>
                  <polygon
                    class="cursor-pointer"
                    stroke='black'
                    points="1,1 1,33 7,25 7,9"
                    fill="#EAEDEA"
                    [attr.fill]="isSelected(tooth.idTooth + '-4') ? 'var(--fluorosis)' : 'var(--white-color)'"
                    (click)="!toothDeactivated[tooth.idTooth] && changeColor(tooth.idTooth + '-4')"/>
                  <polygon
                    class="cursor-pointer"
                    stroke='black'
                    points="7,9 21,9 21,25 7,25"
                    fill="#EAEDEA"
                    [attr.fill]="isSelected(tooth.idTooth + '-5') ? 'var(--fluorosis)' : 'var(--white-color)'"
                    (click)="!toothDeactivated[tooth.idTooth] && changeColor(tooth.idTooth + '-5')"/>
                </svg>
                <span>{{ tooth.idTooth }}</span>
              </div>
            }
          </div>
        }
      </div>
    </mat-tab>
  </mat-tab-group>

    <div class="button-container p-4">
        <button type="button" mat-button (click)="previousTab()"><i class="fas fa-long-arrow-alt-left"></i> <span class="hidden sm:inline"> Anterior</span> </button>
        <div>
            @if (role === ROL.STUDENT) {
                <button class="mr-2" mat-button (click)="store()"> Guardar <i class="fas fa-save"></i></button>
            }
            <button type="button" (click)="nextTab()" mat-button >
                <span class="hidden sm:inline">Avanzar </span>
                <i class="fas fa-long-arrow-alt-right"></i></button>
        </div>
    </div>
}

