<!-- <p>
  <mat-label>Primer Nombre:</mat-label><br />
  <mat-form-field [appearance]="'outline'" class="custom-width">
    <input matInput type="date" placeholder="Placeholder" />
  </mat-form-field>
</p>
<p>
  <mat-label>Fecha</mat-label><br>
  <mat-form-field  [appearance]="'outline'" class="custom-width" >
    <input matInput [matDatepicker]="picker">
    <mat-datepicker-toggle matIconSuffix [for]="picker"></mat-datepicker-toggle>
    <mat-datepicker #picker></mat-datepicker>
  </mat-form-field>
</p> -->



<div class="container mx-auto px-4">
  <form (ngSubmit)="createPatient()">
    <!-- Datos Personales -->
    <div
      class="block p-6 bg-background border border-border rounded-lg shadow dark:bg-background-dark dark:border-border-dark dark:hover:bg-background-dark">
      <h1><i class="fas fa-hospital-user"></i><b>Datos personales</b></h1>
      <br />
      <hr />
      <div class="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-4 gap-4 mt-4 mb-4">
        <!-- Primer Nombre -->
        <div class="relative flex-grow w-full">
          <label class="text-on-background" for="firstName">Nombre:</label>
          <input class="input-field" type="text" id="firstName" [(ngModel)]="firstName" name="firstName" />
        </div>

        <!-- Segundo Nombre -->
        <div class="relative flex-grow w-full">
          <label class="text-on-background" for="secondName">Segundo nombre:</label>
          <input class="input-field" type="text" id="secondName" [(ngModel)]="secondName" name="secondName" />
        </div>

        <!-- Primer Apellido -->
        <div class="relative flex-grow w-full">
          <label class="text-on-background" for="firstLastName">Primer apellido:</label>
          <input class="input-field" type="text" id="firstLastName" [(ngModel)]="firstLastName" name="firstLastName" />
        </div>

        <!-- Segundo Apellido -->
        <div class="relative flex-grow w-full">
          <label class="text-on-background" for="secondLastName">Segundo apellido:</label>
          <input class="input-field" type="text" id="secondLastName" [(ngModel)]="secondLastName"
            name="secondLastName" />
        </div>

        <!-- CURP -->
        <div class="relative flex-grow w-full">
          <label class="text-on-background" for="curp">CURP:</label>
          <input class="input-field" type="text" id="curp" [(ngModel)]="curp" name="curp" maxlength="18"
            (ngModelChange)="validarCurp()" />
          <!-- Mensaje de error si el CURP no es válido -->

          @if (!curpValido && curp.length === 18) {
          <div class="text-red-600">CURP no válida.</div>
          }
        </div>

        <!-- Teléfono -->
        <div class="relative flex-grow w-full">
          <label class="text-on-background" for="phone">Teléfono:</label>
          <input class="input-field" type="tel" id="phone" [(ngModel)]="phone" name="phone" />
        </div>

        <!-- Fecha de Nacimiento -->
        <div class="relative flex-grow w-full">
          <label class="text-on-background" for="birthDate">Fecha de nacimiento:</label>
          <input class="input-field" type="date" id="birthDate" [(ngModel)]="birthDate"
            (change)="onFechaNacimientoChange()" name="birthDate" />
        </div>

        <!-- Correo Electrónico -->
        <div class="relative flex-grow w-full">
          <label class="text-on-background" for="email">Correo electrónico:</label>
          <input class="input-field" type="email" id="email" [(ngModel)]="email" name="email" />
        </div>

        <!-- Género -->
        <div class="relative flex-grow w-full">
          <label class="text-on-background" for="gender">Género:</label>
          <input class="input-field" type="text" id="gender" [formControl]="controlGender"
            [matAutocomplete]="autoGender" [(ngModel)]="gender" (focus)="findGender()" name="gender" />
          <mat-autocomplete #autoGender="matAutocomplete">
            <mat-option *ngFor="let item of filterGender | async" [value]="item">{{ item }}</mat-option>
          </mat-autocomplete>
        </div>
      </div>
    </div>

    <br />
    <!-- Domicilio -->
    <div
  class="block p-6 bg-background border border-border rounded-lg shadow dark:bg-background-dark dark:border-border-dark dark:hover:bg-background-dark">
  <h1><i class="fas fa-map-marked-alt"></i><b class="title-text">Domicilio</b></h1>
  <br />
  <hr />
  <div class="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-4 gap-4 mt-4 mb-4">
    <div class="relative flex-grow w-full">
      <label class="text-on-background" for="streetNumber">Número Exterior:</label>
      <input class="input-field" type="text" id="streetNumber" [(ngModel)]="streetNumber" name="streetNumber" />
    </div>

    <div class="relative flex-grow w-full">
      <label class="text-on-background" for="interiorNumber">Número interior:</label>
      <input class="input-field" type="text" id="interiorNumber" [(ngModel)]="interiorNumber"
        name="interiorNumber" />
    </div>

    <div class="relative flex-grow w-full">
      <label class="text-on-background" for="housingCategory">Categoría de vivienda:</label>
      <input class="input-field" type="text" id="housingCategory" [formControl]="controlHousingData"
        [matAutocomplete]="autoHousing" [(ngModel)]="housingCategory" name="housingCategory"
        (focus)="findHousing()" />
      <mat-autocomplete #autoHousing="matAutocomplete">
        <mat-option *ngFor="let item of filterHousingData | async" [value]="item">{{ item }}</mat-option>
      </mat-autocomplete>
    </div>

    <div class="relative flex-grow w-full">
      <label class="text-on-background" for="streetName">Nombre de calle:</label>
      <input class="input-field" type="text" id="streetName" [formControl]="controlstreetsData"
        [matAutocomplete]="autoStreet" [(ngModel)]="streetName" name="streetName" (focus)="findStreet()" />
      <mat-autocomplete #autoStreet="matAutocomplete">
        <mat-option *ngFor="let item of filterStreetsData | async" [value]="item">{{ item }}</mat-option>
      </mat-autocomplete>
    </div>

    <div class="relative flex-grow w-full">
      <label class="text-on-background" for="neighborhoodName">Nombre de colonia:</label>
      <input class="input-field" type="text" id="neighborhoodName" [formControl]="controlNeighborhood"
        [matAutocomplete]="autoNeighborhood" [(ngModel)]="neighborhoodName" name="neighborhoodName"
        (focus)="findNeighborhood()" />
      <mat-autocomplete #autoNeighborhood="matAutocomplete">
        <mat-option *ngFor="let item of filterNeighborhood | async" [value]="item">{{ item }}</mat-option>
      </mat-autocomplete>
    </div>

    <div class="relative flex-grow w-full">
      <label class="text-on-background" for="localityName">Nombre de localidad:</label>
      <input class="input-field" type="text" id="localityName" [formControl]="controlLocalitie"
        [matAutocomplete]="autoLocality" [(ngModel)]="localityName" name="localityName" (focus)="findLocality()" />
      <mat-autocomplete #autoLocality="matAutocomplete">
        <mat-option *ngFor="let item of filteredLocality | async" [value]="item">{{ item }}</mat-option>
      </mat-autocomplete>
    </div>

    <div class="relative flex-grow w-full">
      <label class="text-on-background" for="postalCode">Código postal:</label>
      <input class="input-field" type="text" id="postalCode" [(ngModel)]="postalCode" name="postalCode" />
    </div>

    <div class="relative flex-grow w-full">
      <label class="text-on-background" for="municipalityName">Nombre de municipio:</label>
      <input class="input-field" type="text" id="municipalityName" [formControl]="controlMunicipality"
        [matAutocomplete]="autoMunicipality" [(ngModel)]="municipalityName" name="municipalityName"
        (input)="getMunicipalityData()" (focus)="findMunicipality()" />
      <mat-autocomplete #autoMunicipality="matAutocomplete">
        <mat-option *ngFor="let item of filterMunicipality | async" [value]="item">{{ item }}</mat-option>
      </mat-autocomplete>
    </div>

    <div class="relative flex-grow w-full">
      <label class="text-on-background" for="stateName">Nombre de estado:</label>
      <input class="input-field" type="text" id="stateName" [formControl]="controlState"
        [matAutocomplete]="autoState" [(ngModel)]="stateName" name="stateName" (focus)="findState()" />
      <mat-autocomplete #autoState="matAutocomplete">
        <mat-option *ngFor="let item of filterSates | async" [value]="item">{{ item }}</mat-option>
      </mat-autocomplete>
    </div>
  </div>
</div>

    <br />
    <!-- Otros datos -->
    <div
  class="block p-6 bg-background border border-border rounded-lg shadow dark:bg-background-dark dark:border-border-dark dark:hover:bg-background-dark">
  <h1><i class="fas fa-file-signature"></i><b class="title-text">Otros datos</b></h1>
  <br />
  <hr />
  <div class="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-4 gap-4 mt-4 mb-16">
    <div class="relative flex-grow w-full">
      <label class="text-on-background" for="admissionDate">Fecha de admisión:</label>
      <input class="input-field" type="date" id="admissionDate" [(ngModel)]="admissionDate" name="admissionDate" />
    </div>

    <div class="relative flex-grow w-full">
      <label class="text-on-background" for="nationalityId">Nacionalidad:</label>
      <input class="input-field" type="text" id="nationalityName" [formControl]="controlNationality"
        [matAutocomplete]="autoNationality" [(ngModel)]="nationalityName" name="nationalityName"
        (focus)="findNationality()" />
      <mat-autocomplete #autoNationality="matAutocomplete">
        <mat-option *ngFor="let item of filteredNationality | async" [value]="item">{{ item }}</mat-option>
      </mat-autocomplete>
    </div>

    <div class="relative flex-grow w-full">
      <label class="text-on-background" for="maritalStatusId">Estado civil:</label>
      <input class="input-field" type="text" id="maritalStatusName" [formControl]="controlMaritalStatus"
        [matAutocomplete]="autoMaritalStatus" [(ngModel)]="maritalStatusName" name="maritalStatusName"
        (focus)="findMaritalStatus()" />
      <mat-autocomplete #autoMaritalStatus="matAutocomplete">
        <mat-option *ngFor="let item of filteredMaritalStatus | async" [value]="item">{{ item }}</mat-option>
      </mat-autocomplete>
    </div>

    <div class="relative flex-grow w-full">
      <label class="text-on-background" for="occupationId">Ocupación:</label>
      <input class="input-field" type="text" id="occupationName" [formControl]="controlOcupation"
        [matAutocomplete]="autoOcupation" [(ngModel)]="occupationName" name="occupationName"
        (focus)="findOccupation()" />
      <mat-autocomplete #autoOcupation="matAutocomplete">
        <mat-option *ngFor="let item of filteredOcupations | async" [value]="item">{{ item }}</mat-option>
      </mat-autocomplete>
    </div>

    <div class="relative flex-grow w-full">
      <label class="text-on-background" for="ethnicGroupId">Grupo étnico:</label>
      <input class="input-field" type="text" id="ethnicGroupName" [formControl]="controlEthnicGroup"
        [matAutocomplete]="auto" [(ngModel)]="ethnicGroupName" name="ethnicGroupName" (focus)="findEthnicGroup()" />
      <mat-autocomplete #auto="matAutocomplete">
        <mat-option *ngFor="let item of filteredEthnicGroup | async" [value]="item">{{ item }}</mat-option>
      </mat-autocomplete>
    </div>

    <div class="relative flex-grow w-full">
      <label class="text-on-background" for="religionId">Religión:</label>
      <input class="input-field" type="text" id="religionName" [formControl]="controlReligion"
        [matAutocomplete]="autoReligion" [(ngModel)]="religionName" name="religionName" (focus)="findReligion()" />
      <mat-autocomplete #autoReligion="matAutocomplete">
        <mat-option *ngFor="let item of filteredReligion | async" [value]="item">{{ item }}</mat-option>
      </mat-autocomplete>
    </div>

    <div class="relative flex-grow w-full">
      <label class="text-on-background" for="lastConsultation">Última Consulta:</label>
      <input class="input-field" type="date" id="lastConsultation" name="lastConsultation" />
    </div>

    <div class="relative flex-grow w-full">
      <label class="text-on-background" for="consultationReason">Motivo de Consulta:</label>
      <input class="input-field" type="text" id="consultationReason" name="consultationReason" />
    </div>
  </div>
</div>
<br />

    <!-- Datos del tutor -->
    @if (youngerForm) {
    <div
      class="block p-6 bg-white border border-gray-200 rounded-lg shadow dark:bg-gray-800 dark:border-gray-700 dark:hover:bg-gray-700">
      <h1><i class="fas fa-user-friends"></i><b>Datos del tutor</b></h1>
      <br />
      <hr />
      <div class="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-4 gap-4 mt-4 mb-16">
        <div class="relative flex-grow w-full">
          <label [class]="labelClass" for="guardianFirstName">Nombre del tutor:</label>
          <input [class]="inputClass" type="text" id="guardianFirstName" [(ngModel)]="guardianFirstName"
            name="guardianFirstName" />
        </div>

        <div class="relative flex-grow w-full">
          <label [class]="labelClass" for="guardianLastName">Apellido del tutor:</label>
          <input [class]="inputClass" type="text" id="guardianLastName" [(ngModel)]="guardianLastName"
            name="guardianLastName" />
        </div>

        <div class="relative flex-grow w-full">
          <label [class]="labelClass" for="guardianPhone">Teléfono del tutor:</label>
          <input [class]="inputClass" type="tel" id="guardianPhone" [(ngModel)]="guardianPhone" name="guardianPhone" />
        </div>

        <div class="relative flex-grow w-full">
          <label [class]="labelClass" for="guardianEmail">Correo electrónico del tutor:</label>
          <input [class]="inputClass" type="email" id="guardianEmail" [(ngModel)]="guardianEmail"
            name="guardianEmail" />
        </div>
      </div>
    </div>
    <br />
    }
    <div class="align-right">
      <button type="submit" mat-raised-button color="primary">
        <i class="fas fa-check"></i>Registrar Paciente
      </button>
    </div>
  </form>
</div>

<app-alert [open]="alertConfig.open" [singleMessage]="alertConfig.singleMessage" [severity]="alertConfig.severity"
  (eventCloseToast)="closeAlert()"></app-alert>